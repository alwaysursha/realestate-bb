{
  "firestore": {
    "rules": "service cloud.firestore {\n  match /databases/{database}/documents {\n    // Allow read access to all documents for all users\n    match /{document=**} {\n      allow read: if true;\n    }\n    \n    // Allow write access to authenticated users\n    match /users/{userId} {\n      allow write: if request.auth != null && (request.auth.uid == userId || request.resource.data.role == 'admin');\n    }\n    \n    // Allow admin users to write to all collections\n    match /{collection}/{document=**} {\n      allow write: if request.auth != null && exists(/databases/$(database)/documents/users/$(request.auth.uid)) && get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // Allow agents to write to their own properties\n    match /properties/{propertyId} {\n      allow write: if request.auth != null && \n                    exists(/databases/$(database)/documents/agents/$(request.resource.data.agentId)) && \n                    get(/databases/$(database)/documents/agents/$(request.resource.data.agentId)).data.userId == request.auth.uid;\n    }\n    \n    // Allow agents to write to their own agent document\n    match /agents/{agentId} {\n      allow write: if request.auth != null && \n                    exists(/databases/$(database)/documents/agents/$(agentId)) && \n                    get(/databases/$(database)/documents/agents/$(agentId)).data.userId == request.auth.uid;\n    }\n  }\n}"
  },
  "storage": {
    "rules": "rules_version = '2';\nservice firebase.storage {\n  match /b/{bucket}/o {\n    // Allow read access to all files for all users\n    match /{allPaths=**} {\n      allow read: if true;\n    }\n    \n    // Allow admin users to write to all paths\n    match /{allPaths=**} {\n      allow write: if request.auth != null && \n                    exists(/databases/$(database)/documents/users/$(request.auth.uid)) && \n                    get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // Allow agents to write to their own property images\n    match /properties/{fileName} {\n      allow write: if request.auth != null && \n                    exists(/databases/$(database)/documents/agents/$(request.resource.metadata.agentId)) && \n                    get(/databases/$(database)/documents/agents/$(request.resource.metadata.agentId)).data.userId == request.auth.uid;\n    }\n    \n    // Allow agents to write to their own profile images\n    match /agents/{fileName} {\n      allow write: if request.auth != null && \n                    exists(/databases/$(database)/documents/agents/$(request.resource.metadata.agentId)) && \n                    get(/databases/$(database)/documents/agents/$(request.resource.metadata.agentId)).data.userId == request.auth.uid;\n    }\n  }\n}"
  }
} 